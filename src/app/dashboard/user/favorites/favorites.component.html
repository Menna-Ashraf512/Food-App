<section>
  <div class="container-fluid">
    <div class="my-3">
      <div class="d-flex flex-column flex-lg-row justify-content-center gap-2 align-items-center mb-2  mx-auto">
        <div class="d-flex flex-column flex-md-row gap-2">
          <mat-form-field class="tag">
            <mat-label>Tag</mat-label>
            <mat-select [(value)]="selectedTag" (selectionChange)="applyFilter()">
              <mat-option>All</mat-option>
              <mat-option *ngFor="let tag of tagsList" value={{tag.id}}>{{tag.name}}</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="cat">
            <mat-label>Category</mat-label>
            <mat-select [(value)]="selectedCat" (selectionChange)="applyFilter()">
              <mat-option>All</mat-option>
              <mat-option *ngFor="let cat of categoryList" value={{cat.id}}>{{cat.name}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="input_search">
          <span><i class="fa-solid fa-magnifying-glass"></i></span>
          <input [(ngModel)]="name" (keydown.enter)="getAllFavorite()" type="text" class="form-control"
            placeholder="Search By Name....">
        </div>
        <div class="">
          <span (click)="isTable=true"><i class="fa-solid fa-table-list fs-3" [class.text-success]="isTable"></i></span>
          <span (click)="isTable=false"><i class="fa-solid fa-table fs-3" [class.text-success]="!isTable"></i></span>
        </div>
      </div>
      <ng-container *ngIf="favList.length > 0; else noData">
        <ng-container *ngIf="isTable; else elseTemplate">
          <table class="table table-responsive ">
            <thead>

              <tr>
                <th scope="col">Name</th>
                <th scope="col">Image</th>
                <th scope="col">Price</th>
                <th scope="col">Description</th>
                <th scope="col">Tag</th>
                <th scope="col">Category</th>
                <th scope="col">Actions</th>
              </tr>
            </thead>
            <tbody *ngIf="favList.length > 0; else noData">
              <tr *ngFor="let item of favList">
                <td>{{item.recipe.name}}</td>
                <td>
                  <img aria-label="Recipe image" class="recipe_img"
                    [src]="item.recipe.imagePath ? baseUrl + item.recipe.imagePath : 'assets/images/img-recipe.jpg'"
                    [alt]="item.recipe.name">
                </td>
                <td>{{item.recipe.price}}</td>
                <td>{{item.recipe.description}}</td>
                <td>{{item.recipe.tag.name}}</td>
                <td>
                  <ng-container *ngFor="let cat of item.recipe.category; let last = last">
                    {{ cat.name }}<span *ngIf="!last">, </span>
                  </ng-container>
                </td>
                <td>
                  <button aria-label="More options" class="btn border-0" data-bs-toggle="dropdown"
                    aria-expanded="false"><i class="fa-solid fa-ellipsis"></i>
                  </button>
                  <ul class="dropdown-menu">
                    <li>
                      <a (click)="deleteFavorite(item.id)"
                        class="dropdown-item cursor-pointer d-flex justify-content-center p-0 align-items-center gap-2">
                        <i class="fa-regular text-danger fa-trash-alt"></i>
                        Remove
                      </a>
                    </li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>
        </ng-container>
<ng-template #elseTemplate>
  <div class="container">
    <div class="cards-grid">
      <div class="card" *ngFor="let item of favList">
        <div>
          <img aria-label="Recipe image" class="recipe_img"
            [src]="item.recipe.imagePath ? baseUrl + item.recipe.imagePath : 'assets/images/img-recipe.jpg'"
            [alt]="item.recipe.name">
        </div>
        <div class="recipe_info">
          <h3>{{item.recipe.name}}</h3>
          <p class="text-muted">{{item.recipe.description}}</p>
          <div class="d-flex align-items-center justify-content-between">
            <p class="badge bg-success">{{item.recipe.tag.name}}</p>
            <p class="badge primary_bg">price : {{item.recipe.price}} $</p>
          </div>
        </div>
        <button aria-label="Delete item" type="button" (click)="deleteFavorite(item.id)"
          class="btn btn_favorite">
          <i class="fa-solid fa-heart"></i>
        </button>
      </div>
    </div>
  </div>
</ng-template>

      </ng-container>
    </div>
    <ng-template #noData>
      <div class="text-center mt-5">
        <img src="../../../../assets/images/vector-puppis.png" alt="No Data">
        <div class="py-3">
          <h5 class="m-0 p-0">No Data !</h5>
          <p class="text-muted">
            are you sure you want to delete this item ? if you are sure just<br>
            click on delete it
          </p>
        </div>
      </div>
    </ng-template>
    <div class="my-4" *ngIf="favList.length>0">
      <mat-paginator [length]="favData.totalNumberOfRecords" [pageSizeOptions]="[5, 10, 30]" aria-label="Select page"
        (page)="handlePageEvent($event)">
      </mat-paginator>
    </div>
  </div>
</section>
